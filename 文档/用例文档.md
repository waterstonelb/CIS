
# 用例文档

|人员|日期|修改原因|版本|
|:-:|:-:|:-:|:-:|
|梁斌|2019/5/23|增加基本内容|v0.0|
|马永昶|2019/6/2|增加相关用例|v0.1|
|梁斌|2019/6/18|修改用例图|v0.2|

## 目录

<!-- TOC -->      
- [1. 引言](#1-引言)     
  - [1.1 目的](#11-目的)     
  - [1.2 阅读说明](#12-阅读说明)     
- [2. 用例图](#2-用例图)     
- [3. 用例列表](#3-用例列表)     
- [4. 详细用例描述](#4-详细用例描述)     
  - [4.1 管理员](#41-管理员)     
    - [4.1.1 会员政策管理](#411-会员政策管理)    
    - [4.1.2 退票策略管理](#412-退票策略管理)     
    - [4.1.3 影厅信息管理](#413-影厅信息管理)     
    - [4.1.4 影院角色管理](#414-影院角色管理)     
    - [4.1.5 赠送优惠券](#415-赠送优惠券)     
  - [4.2 用户](#42-用户)     
    - [4.2.1 购票](#421-购票)     
    - [4.2.2 出票](#422-出票)     
    - [4.2.3 退票](#423-退票)     
    - [4.2.4 查看历史充值、消费记录](#424-查看历史充值消费记录)   
- [5. 需求分析模型](#5-需求分析模型)     
  - [5.1 系统顺序图](#51-系统顺序图)     
  - [5.2 概念类图](#52-概念类图)     
  - [5.3 状态图](#53-状态图)      
<!-- /TOC -->

## 1. 引言

### 1.1 目的

- 构建一个完整并且性能较为优异的影院购票系统

### 1.2 阅读说明

- 文中所有图片托管在sm.ms网站

## 2. 用例图

![用例图.png](https://i.loli.net/2019/06/20/5d0ba8da6835f55521.png)


## 3. 用例列表

- 影院
  1. 会员政策管理
  2. 退票策略管理
  3. 影厅信息管理
  4. 影院角色管理
  5. 赠送优惠券
- 观众
  1. 购票
  2. 出票
  3. 退票
  4. 查看历史充值、消费记录

## 4. 详细用例描述

### 4.1 影院

#### 4.1.1 会员政策管理

- 用例编号：01
- 名称：会员政策管理
- 创建者：全体
- 创建日期：2019/6/7
- 最后一次更新者：马永昶
- 更新日期：2019/6/17
- 参与者 ：经理
- 触发条件：经理需要调整会员政策
- 前置条件：
  1. 经理要被识别和授权
- 后置条件：
  1. 更新会员政策
  2. 存储操作记录
- 优先级：高
- 正常流程：
  1. 点击管理会员卡
  2. 请求确认
  3. 保存会员卡修改

- 扩展流程：
  1a. 点击新增会员卡:
  1. 单个新增
  2. 输入新卡信息

  1b. 点击修改会员卡：
  1. 选择需要修改的会卡
  2. 对其进行修改或使其失效

  2-3a. 请求撤销操作
- 特殊需求：无

#### 4.1.2 退票策略管理

- 用例编号：02
- 名称：退票策略管理
- 创建者：全体
- 创建日期：2019/6/7
- 最后一次更新者：马永昶
- 更新日期：2019/6/17
- 参与者 ：员工
- 触发条件：员工需要变更退票策略
- 前置条件：
  1. 员工要被识别和授权
- 后置条件：
  1. 更新退票策略
  2. 存储操作记录
- 优先级：高
- 正常流程：
  1. 管理员点击“管理退票”按钮
  2. 请求确认
  3. 对变更进行存储

- 扩展流程： 
  1a. 点击新增退票策略
  1. 输入时间限制和退款比例
  2. 退出

  1b. 点击修改退票策略
  1. 选择要修改的策略
  2. 输入新的时间限制和退款比例
  3. 退出

   1-2a. 请求撤销操作

#### 4.1.3 影厅信息管理

- 用例编号：03
- 名称：影厅信息管理
- 创建者：全体
- 创建日期：2019/6/7
- 最后一次更新者：马永昶
- 更新日期：2019/6/17
- 参与者 ：管理员
- 触发条件：管理员需要调整影厅
- 前置条件：
  1. 管理员要被识别和授权
- 后置条件：
  1. 更新影厅信息
  2. 存储操作记录
- 优先级：高
- 正常流程：
  1. 点击管理影厅
  2. 请求确认
  3. 保存影厅修改

- 扩展流程：
  1a. 点击新增影厅:
  1. 输入影厅名称、座位数量
  
  1b. 点击修改影厅：
  1. 选择需要修改的影厅
  2. 输入影厅名称、座位数量或使其失效

  2-3a. 请求撤销操作
- 特殊需求：无

#### 4.1.4 影院角色管理

- 用例编号：04
- 名称：影院角色管理
- 创建者：全体
- 创建日期：2019/6/7
- 最后一次更新者：马永昶
- 更新日期：2019/6/17
- 参与者 ：管理员
- 触发条件：管理员需要调整系统角色
- 前置条件：
  1. 管理员要被识别和授权
- 后置条件：
  1. 更新角色信息
  2. 存储操作记录
- 优先级：高
- 正常流程：
  1. 点击管理角色
  2. 请求确认
  3. 保存角色修改

- 扩展流程：
  1a. 点击新增角色:
  1. 填写角色信息并新增
  
  1b. 点击修改角色：
  1. 选择需要修改的已有角色
  2. 对其进行修改或使其失效

  2-3a. 请求撤销操作
- 特殊需求：无

#### 4.1.5 赠送优惠券

- 用例编号：05
- 名称：赠送优惠券
- 创建者：全体
- 创建日期：2019/6/7
- 最后一次更新者：马永昶
- 更新日期：2019/6/17
- 参与者 ：管理员
- 触发条件：管理员需要赠送优惠券
- 前置条件：
  1. 管理员要被识别和授权
- 后置条件：
  1. 更新优惠券信息
  2. 存储操作记录
- 优先级：高
- 正常流程：
  1. 点击赠送优惠券
  2. 选择优惠券种类，优惠策略
  3. 选择部分会员赠送
  4. 请求确认
  5. 保存优惠券信息

- 扩展流程：
  3a. 查询会员名单
  1. 管理员查询指定时间段
  2. 显示消费最多的会员名单

  2-3a. 请求撤销操作
- 特殊需求：无

### 4.2 用户

#### 4.2.1 购票

- 用例编号：06
- 名称：购票
- 创建者：全体
- 创建日期：2019/6/7
- 最后一次更新者：马永昶
- 更新日期：2019/6/17
- 参与者 ：观众
- 触发条件：观众想购票
- 前置条件：
  1. 观众已经正确登陆并进入相应系统界面
- 后置条件：
  1. 存储用户购票信息
  2. 存储影厅座位占用信息
- 优先级：高
- 正常流程：
  1. 观众点击购票
  2. 填写购票数量
  3. 选择座位
  4. 根据用户会员卡信息计算会员卡打折后的票价
  5. 请求用户确认支付
  6. 等待用户支付
  7. 支付成功，显示支付成功

- 扩展流程：

  2a. 填写优惠信息：
  1. 根据用户所选择的电影和用户账户显示用户可用优惠券
  2. 用户选择需要使用的优惠券

  6a. 支付失败
  1. 提示支付失败
  2. 返回

  6b. 支付退出

  1. 已锁座的票进入购物车
  2. 可在已购电影票界面进行结算

  2-6a. 请求撤销操作
- 特殊需求：无

#### 4.2.2 出票

- 用例编号：07
- 名称：出票
- 创建者：全体
- 创建日期：2019/6/7
- 最后一次更新者：马永昶
- 更新日期：2019/6/17
- 参与者 ：观众
- 触发条件：观众想出票
- 前置条件：
  1. 观众已经正确登陆并进入相应系统界面
- 后置条件：
  1. 更新用户订单信息
- 优先级：高
- 正常流程：
  1. 观众点击出票
  2. 选择出票项目
  3. 点击出票
  4. 请求确认
  5. 显示票的信息
  6. 将已经出票的项目的状态设置为已出票

- 扩展流程：
  4a. 请求撤销操作
- 特殊需求：无

#### 4.2.3 退票

- 用例编号：08
- 名称：退票
- 创建者：全体
- 创建日期：2019/6/7
- 最后一次更新者：马永昶
- 更新日期：2019/6/17
- 参与者 ：观众
- 触发条件：观众想退票
- 前置条件：
  1. 观众已经正确登陆并进入相应系统界面
- 后置条件：
  1. 更新用户订单信息
- 优先级：高
- 正常流程：
  1. 观众点击退票
  2. 选择退票项目
  3. 根据退票策略计算出可以退还的金额
  4. 点击退票
  5. 请求确认
  6. 将已经退票的订单的状态设置为已退票
  7. 将退票费用返还用户

- 扩展流程：
  
  3a. 退票策略以实时策略为准

  5a. 请求撤销操作
- 特殊需求：无

#### 4.2.4 查看历史充值、消费记录

- 用例编号：09
- 名称：查看历史充值、消费记录
- 创建者：马永昶
- 创建日期：2019/6/7
- 最后一次更新者：马永昶
- 更新日期：2019/6/17
- 参与者 ：观众
- 触发条件：观众想要查看历史充值和消费记录
- 前置条件：
  1. 观众被识别和授权
- 后置条件：无
- 优先级：中
- 正常流程：
  1. 用户点击查看历史记录
- 扩展流程：
  1a. 用户查询历史充值记录
  1. 用户点击查看历史充值记录
  2. 显示用户所有的充值记录

  2a. 用户查询历史消费记录
  1. 用户点击查看历史消费记录
  2. 显示用户所有消费记录

## 5. 需求分析模型

### 5.1 系统顺序图

  1. 用例1系统顺序图
   [![Sequence Diagram0.jpg](https://i.loli.net/2019/06/18/5d088966f08b530870.jpg)](https://i.loli.net/2019/06/18/5d088966f08b530870.jpg)
  2. 用例2系统顺序图
   [![Sequence Diagram1.jpg](https://i.loli.net/2019/06/18/5d08899b4147457455.jpg)](https://i.loli.net/2019/06/18/5d08899b4147457455.jpg)
  3. 用例3系统顺序图
   [![Sequence Diagram2.jpg](https://i.loli.net/2019/06/18/5d0889ae4a8cb95118.jpg)](https://i.loli.net/2019/06/18/5d0889ae4a8cb95118.jpg)
  4. 用例4系统顺序图
   [![Sequence Diagram3.jpg](https://i.loli.net/2019/06/18/5d0889c0310c940683.jpg)](https://i.loli.net/2019/06/18/5d0889c0310c940683.jpg)
  5. 用例5系统顺序图
   [![Sequence Diagram4.jpg](https://i.loli.net/2019/06/18/5d0889c01c39091319.jpg)](https://i.loli.net/2019/06/18/5d0889c01c39091319.jpg)
  6. 用例6系统顺序图
   [![Sequence Diagram5.jpg](https://i.loli.net/2019/06/18/5d088a2b0a57612219.jpg)](https://i.loli.net/2019/06/18/5d088a2b0a57612219.jpg)
  7. 用例7系统顺序图
   [![Sequence Diagram6.jpg](https://i.loli.net/2019/06/18/5d088a60a25e099879.jpg)](https://i.loli.net/2019/06/18/5d088a60a25e099879.jpg)
  8. 用例8系统顺序图
   [![Sequence Diagram7.jpg](https://i.loli.net/2019/06/18/5d088a60999ee76290.jpg)](https://i.loli.net/2019/06/18/5d088a60999ee76290.jpg)
  9. 用例9系统顺序图
   [![Sequence Diagram8.jpg](https://i.loli.net/2019/06/18/5d088a627b2f598186.jpg)](https://i.loli.net/2019/06/18/5d088a627b2f598186.jpg)

### 5.2 概念类图

- 全局概念类图
  ![Class Diagramall.png](https://i.loli.net/2019/06/18/5d090185f121121219.png)
1. 用例1概念类图
  ![Class Diagram0.png](https://i.loli.net/2019/06/18/5d09018b4fc8486051.png)
2. 用例2概念类图
  ![Class Diagram1.png](https://i.loli.net/2019/06/18/5d09018b4911830381.png)
3. 用例3概念类图
  ![Class Diagram2.png](https://i.loli.net/2019/06/18/5d09018d782db92640.png)
4. 用例4概念类图
  ![Class Diagram3.png](https://i.loli.net/2019/06/18/5d0901901340399201.png)
5. 用例5概念类图
  ![Class Diagram4.png](https://i.loli.net/2019/06/18/5d090190b51e450009.png)
6. 用例6概念类图
   ![Class Diagram5.png](https://i.loli.net/2019/06/18/5d0901924615995693.png)
7. 用例7概念类图
   ![Class Diagram6.png](https://i.loli.net/2019/06/18/5d09019306fea68394.png)
8. 用例8概念类图
   ![Class Diagram7.png](https://i.loli.net/2019/06/18/5d09023338b0e27896.png)
9. 用例9概念类图
   ![Class Diagram8.png](https://i.loli.net/2019/06/18/5d090195d0d0817860.png)
### 5.3 状态图

- 购票——状态图
  [![购票状态图.jpg](https://i.loli.net/2019/06/18/5d088afca253a15811.jpg)](https://i.loli.net/2019/06/18/5d088afca253a15811.jpg)
